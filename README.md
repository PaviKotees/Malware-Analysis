# Malware Analysis Lab
Creation of Malware Analysis Lab on local machine using Flare VM and Remnux.

**Platforms used to build self-hosted Malware Analysis Lab:**

To self-host a lab, the following platforms will be used:

**Oracle VirtualBox** - Detonating malware onto our main working system is not advised, hence the use of VirtualBox to create a sandbox environment.

**Flare VM** - installed on Windows 10 base machine is a collection of software installation scripts for Windows systems that allows the setup of a analysis lab and reverse engineering environment in Virtual Machine(VM). This machine is where the malware will be installed and detonated.

**Remnux** - similar version of Flare VM but for Linux OS, this machine will be used as a C2 server during dynamic analysis of malware.


## Introduction

Upon passing the [CompTIA Security+](https://www.comptia.jp/pdf/CompTIA%20Security+%20SY0-601%20Exam%20Objectives%20(3.0).pdf), I realized that I needed hands on experience with malware hence I decided to create a Malware Analysis Lab and document the process.

In this page, I will be documenting the important steps I followed to setup a Malware Analysis Lab with [FlareVM](https://github.com/mandiant/flare-vm) and Remnux. Later on I will be analysing various malware and list out their fingerprints, behaviours, Indicators of Compromise (IoCs) etc.

**Topology**

<img src="https://github.com/PaviKotees/pavikotees/assets/154454339/5ab64857-5f3d-47a3-b4d7-c4bf9ef09216" height="50%" width="50%"/>


Will be utlized during Dynamic Analysis.

**Tools used for Analysis**

- VirusTotal - Analyze files and URLs for viruses, worms, trojan and other kinds of malicious content.
- Pestudio - Used to statically analyze executlable files for malicious artifacts
- Cutter - Advanced and open-source tool for reverse engineering malware.
- Procmon - Process Monitor is used for real-time monitoring of all file system acitivity.

**Malware Analyzed**

- Zeus Banking Trojan
- PDF Malware

  **Overview of analysis**

  - Fingerprint of the malware
  - Static Analysis
  - Dynamic Analysis

# The Project

## Installation of Flare VM

To be able to create the laboratory it is important know the working of Oracle Virtualbox since that is our base and install Windows 10 Enterprise with atleast 75GB of allocated memory to avoid storage issues.

<img src="https://github.com/PaviKotees/Malware-Analysis/assets/154454339/8f7ea96f-0866-4092-b69c-1aff705cb700" height="50%" width="50%"/>

Domain join the Windows 10 machine and fill out the required fields.

<img src="https://github.com/PaviKotees/Malware-Analysis/assets/154454339/8278e290-ad86-4c36-9987-ca1ca011a126" height="50%" width="50%"/>

Disable the Windows Defender Firewall on this machine, this step is required since this is the machine we will be installing Flare VM containing all the tools required to analyze the malware. Windows Defender will block Flare VM and the malware, as it should, if enabled. ( not recommended in the environment you work in or any other personal environment )

<img src="https://github.com/PaviKotees/Malware-Analysis/assets/154454339/050473b4-e475-471a-910f-ebcab3977c7c" height="50%" width="50%"/>

**Create a snapshot of the machine, to restore machine to this point if anything goes wrong when installing Flare VM or when running malware.**

Download the Flare VM installation file : https://github.com/mandiant/flare-vm/blob/main/install.ps1 onto the Windows 10 VM.

Run PowerShell as administrator:

- Run: ```Unblock-File .\install.ps1``` to unblock the installer.
- Run: ```Set-ExecutionPolicy Unrestricted```
- Run ```.\install.ps1```

<img src="https://github.com/PaviKotees/Malware-Analysis/assets/154454339/6d82edb2-ce96-4275-a570-9d35e6b62a35" height="50%" width="50%"/>

Flare VM takes a few hours to install, it restarts plenty of times and finally starts with the Flare OS installed.

<img src="https://github.com/PaviKotees/Malware-Analysis/assets/154454339/ad55d256-ae2a-4480-ba52-0493914f9e63" height="44%" width="44%"/>  <img src="https://github.com/PaviKotees/Malware-Analysis/assets/154454339/5693a251-c8b5-4f30-a467-348354508a32" height="50%" width="50%"/>

**Working on uploading the rest of the project**


